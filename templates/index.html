<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Христианский тест</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body {
    background: linear-gradient(180deg, #0b1d3a 0%, #1a2a5a 100%);
    font-family: 'Arial', sans-serif;
    margin: 0; padding: 0;
    overflow-x: hidden;
    color: #fff;
}
.star { position:absolute; width:4px; height:4px; background:radial-gradient(circle,#fff,#ffd700); border-radius:50%; opacity:0; animation:twinkle 3s infinite;}
@keyframes twinkle{0%,100%{opacity:0;transform:scale(0.5);}50%{opacity:1;transform:scale(1.2);}}
.floating-img {position:absolute;width:50px; animation:floatUpDown 5s ease-in-out infinite;}
@keyframes floatUpDown{0%,100%{transform:translateY(0);}50%{transform:translateY(-15px);}}
.main-container {display:flex; flex-wrap:wrap; gap:20px; margin:20px;}
.left-col {flex:1 1 300px; text-align:center;}
.left-col img {max-width:100%; border-radius:25px; box-shadow:0 0 30px rgba(255,215,0,0.4); transition: transform 0.3s, box-shadow 0.3s;}
.left-col img:hover {transform:scale(1.05); box-shadow:0 0 45px rgba(255,215,0,0.7);}
.center-col {flex:1 1 400px; background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); padding:40px 30px; border-radius:25px; box-shadow:0 12px 30px rgba(0,0,0,0.5); text-align:center; color:#ffeaa7;}
.center-col h1 {font-size:2rem; margin:20px 0; color:#fff6c3; text-shadow:0 0 10px rgba(255,255,255,0.6),0 0 20px rgba(255,215,0,0.3);}
.auth-form {background: rgba(255,255,255,0.1); padding: 25px; border-radius: 20px; box-shadow: 0 8px 25px rgba(255,215,0,0.3); margin-top: 20px; display: flex; flex-direction: column; gap: 15px;}
.auth-form input {padding: 12px 15px; border-radius: 15px; border: none; outline: none; font-size: 1rem; background: rgba(255,255,255,0.05); color: #fff; box-shadow: inset 0 0 5px rgba(0,0,0,0.2); transition: all 0.3s;}
.auth-form input::placeholder { color: #ffeaa7aa; }
.auth-form input:focus { background: rgba(255,255,255,0.15); box-shadow: 0 0 10px rgba(255,215,0,0.5); }
.btn-custom { background: linear-gradient(135deg, rgba(255, 215, 0,0.8), rgba(255, 235, 130,0.8)); color: #0b1d3a; border: none; padding: 15px 0; font-weight: bold; font-size: 1.3rem; border-radius: 20px; box-shadow: 0 8px 25px rgba(255,215,0,0.4); transition: transform 0.3s, box-shadow 0.3s; cursor:pointer; }
.btn-custom:hover { transform: scale(1.08); box-shadow: 0 12px 30px rgba(255,215,0,0.6); }
.error-text { color:#ff6666; font-weight:bold; display:none; text-align:left; }
.right-col { flex:1 1 350px; display:flex; flex-direction:column; gap:25px; }
.sidebar { background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); padding:30px 25px; border-radius:25px; box-shadow:0 15px 35px rgba(0,0,0,0.4); transition:0.4s; }
.sidebar:hover { transform: translateY(-8px); box-shadow:0 20px 40px rgba(0,0,0,0.5); }
.sidebar h5 { margin-bottom:15px; font-weight:bold; color:#ffeaa7; font-size:1.3rem; border-bottom:2px solid rgba(255,215,0,0.6); padding-bottom:8px; }
.sidebar p { margin-bottom:12px; line-height:1.6; color:#fff6c3; }
.footer { text-align:center; margin:50px 0; padding:25px; background-color: rgba(0,0,0,0.3); border-top:1px solid rgba(255,255,255,0.2); font-size:0.95rem; color:#fff6c3; }
@media (max-width:1024px){ .main-container{flex-direction:column;} .right-col{flex-direction:column;} }
#house-container { position: relative; width: 300px; margin:50px auto; }
#flying-angel { position:absolute; display:none; width:50px; z-index:10; }
</style>
</head>
<body>

<div class="star" style="top:10%; left:20%;"></div>
<div class="star" style="top:30%; left:60%; animation-delay:1s;"></div>
<div class="star" style="top:50%; left:40%; animation-delay:2s;"></div>
<div class="star" style="top:70%; left:80%; animation-delay:1.5s;"></div>
<img src="/static/snowflake.png" class="floating-img" style="top:40%; left:70%;">

<div id="house-container">
    <div class="left-col">
        <img src="/static/jesus.png" alt="Христос">
    </div>
    <img src="/static/angel.png" id="flying-angel" alt="Ангел">
</div>

<div class="main-container">
    <div class="center-col">
        <img src="/static/13-bible.png" alt="Библия" style="max-width:100px; box-shadow:0 0 25px rgba(255,215,0,0.5);">
        <div class="golden-verse mb-3" style="font-style: italic;">“И всё, что делаете, делайте от души, как для Господа” (Кол. 3:23)</div>
        <h1>Добро пожаловать на тест о Рождестве Христовом!</h1>
        <p>Введите свои данные для начала теста:</p>

        <form id="authForm" class="auth-form">
            <input type="text" id="lastname" placeholder="Фамилия">
            <input type="text" id="firstname" placeholder="Имя">
            <input type="text" id="middlename" placeholder="Отчество">
            <input type="number" id="age" placeholder="Возраст" min="1">
            <div id="errorMsg" class="error-text">⚠ Заполните все поля!</div>
            <button type="button" class="btn btn-custom" onclick="startTest()">Начать тест</button>
        </form>
    </div>

    <div class="right-col">
        <div class="sidebar">
            <h5>Информация о тесте</h5>
            <p>Возделывайте и наполняйте свои знания о слове Божьем и укрепите свою веру.</p>
        </div>
        <div class="sidebar">
            <h5>Слово Жизни</h5>
            <p><em>«Ибо младенец родился нам — Сын дан нам…»</em><br>Исаия 9:6</p>
        </div>
    </div>
</div>

<footer class="footer">
«Ибо так возлюбил Бог мир, что отдал Сына Своего Единородного…» — Иоанна 3:16
</footer>

<script>
// ---------- Летающий ангел ----------
const angel = document.getElementById('flying-angel');
const house = document.getElementById('house-container');

function flyAngelAboveHouse(){
    const angelWidth = angel.offsetWidth;
    const angelHeight = angel.offsetHeight;
    const x = Math.random() * (house.clientWidth - angelWidth);
    const y = Math.random() * ((house.clientHeight/2) - angelHeight);
    angel.style.left = x + 'px';
    angel.style.top = y + 'px';
    angel.style.opacity = 0;
    angel.style.display = 'block';
    angel.animate([{opacity:0, transform:'scale(0.5)'},{opacity:1, transform:'scale(1)'}],{duration:500, fill:'forwards'});
    setTimeout(()=>{
        angel.animate([{opacity:1, transform:'scale(1)'},{opacity:0, transform:'scale(0.5)'}],{duration:500, fill:'forwards'});
        setTimeout(()=>{angel.style.display='none';},500);
    }, 1000+Math.random()*2000);
}
function startFlyingAngel(){flyAngelAboveHouse(); setTimeout(startFlyingAngel,1000+Math.random()*2000);}
startFlyingAngel();

</script>

<script>
// ---------- Валидация формы при отправке ----------
function startTest() {
    const lastname = document.getElementById('lastname').value.trim();
    const firstname = document.getElementById('firstname').value.trim();
    const middlename = document.getElementById('middlename').value.trim();
    const ageStr = document.getElementById('age').value.trim();
    const age = parseInt(ageStr);
    const errorMsg = document.getElementById('errorMsg');

    // Регэксп для ФИО (только буквы, пробел и дефис)
    const nameRegex = /^[А-Яа-яЁёA-Za-z\s-]+$/;

    if (!lastname || !firstname || !ageStr || isNaN(age) || age < 1 || age > 120 ||
        !nameRegex.test(lastname) || !nameRegex.test(firstname) || (middlename && !nameRegex.test(middlename))) {
        errorMsg.textContent = "⚠ Проверьте ФИО и возраст! Только буквы, пробелы и дефисы. Возраст 1-120.";
        errorMsg.style.display = 'block';
        return; // блокируем отправку
    }

    errorMsg.style.display = 'none';

    // Сохраняем данные в sessionStorage
    sessionStorage.setItem("user_data", JSON.stringify({ lastname, firstname, middlename, age }));

    // Редирект на страницу теста с query params
    const params = new URLSearchParams({ lastname, firstname, middlename, age }).toString();
    window.location.href = `/test?${params}`;
}

// ---------- Ограничение ввода символов ----------
function allowOnlyLetters(event) {
    const char = event.key;
    const allowed = /[А-Яа-яЁёA-Za-z\s-]/;
    const controlKeys = ['Backspace','Delete','Tab','ArrowLeft','ArrowRight','Enter'];
    if (!allowed.test(char) && !controlKeys.includes(char)) {
        event.preventDefault();
    }
}

function allowOnlyNumbers(event) {
    const char = event.key;
    const controlKeys = ['Backspace','Delete','Tab','ArrowLeft','ArrowRight','Enter'];
    if (!/[0-9]/.test(char) && !controlKeys.includes(char)) {
        event.preventDefault();
    }
}

// ---------- Навешиваем фильтры на поля ----------
document.getElementById('lastname').addEventListener('keypress', allowOnlyLetters);
document.getElementById('firstname').addEventListener('keypress', allowOnlyLetters);
document.getElementById('middlename').addEventListener('keypress', allowOnlyLetters);

const ageInput = document.getElementById('age');
ageInput.addEventListener('keypress', allowOnlyNumbers);

// ---------- Проверка диапазона возраста при потере фокуса ----------
ageInput.addEventListener('blur', function() {
    let value = parseInt(this.value);
    if (isNaN(value) || value < 1) this.value = 1;
    else if (value > 120) this.value = 120;
});
</script>



</body>
</html>
